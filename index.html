<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>Ana Duspara</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>
<style>
.webgl {
    height:100vh;
    width:100vw;
}
.click {
    position:absolute;
    top:1%;
    width:auto;
    height:20px;
    border:1px solid red;
    cursor:pointer;
    color:black;
    background-color:white;
}
</style>
<script src="http://threejs.org/build/three.min.js"></script>
<script src="http://threejs.org/examples/js/libs/tween.min.js"></script>
<script src="http://threejs.org/examples/js/controls/OrbitControls.js"></script>

<script src="http://threejs.org/examples/js/renderers/Projector.js"></script>
<script src="http://jeromeetienne.github.io/threex.domevents/threex.domevents.js"></script>

<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="http://threejs.org/examples/js/ImprovedNoise.js"></script>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<body style="overflow:hidden;">

<style>

.modal-content {
    background-color: rgba(225,225,225, .1) !important;
}
.navi{
  position: absolute;
  bottom: 0;
}

@media (min-width: 768px){}
.modal-dialog {
    width: 670px !important;
    margin: 15% auto !important;
  }
}
</style>


<div id="webgl" class="webgl"></div>

<div class="navi">

<!-- Modal 1-->
<div class="modal fade" id="ClickContent1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
      <iframe src="https://player.vimeo.com/video/144248888" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe><p><a href="https://vimeo.com/144248888">Secret Space Program Conference 2015</a> from <a href="https://vimeo.com/globalbem">Breakthrough Energy Movement</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal 2-->
<div class="modal fade" id="ClickContent2" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
      <iframe src="https://player.vimeo.com/video/89454625" width="640" height="360" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe> <p><a href="https://vimeo.com/89454625">Ana Duspara Showreel</a> from <a href="https://vimeo.com/user2237446">Ana Duspara</a> on <a href="https://vimeo.com">Vimeo</a>.</p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>


</div>

<script>


  var camera;
  var controls;
  var scene;
  var light;

  var raycaster;
  var mouse;

  var renderer;
  var w = window.innerWidth;
  var h = window.innerHeight;

  var worldWidth = 100, worldDepth = 25,
  worldHalfWidth = worldWidth / 2, worldHalfDepth = worldDepth / 2;


  init();
  animate();

  function init() {

      //camera
      camera = new THREE.PerspectiveCamera(45, w / h, 1, 20000);
      camera.position.set(0, 1000, -1500);

      //controls
      controls = new THREE.OrbitControls(camera);
      controls.rotateSpeed = 1.0;
      controls.zoomSpeed = 1.2;
      controls.panSpeed = 0.8;

      //Scene
      scene = new THREE.Scene();

      // Helpers
      axes = new THREE.AxisHelper(10000);
      scene.add(axes);
      helper = new THREE.GridHelper(1000, 10);
      scene.add(helper);

      //Hemisphere Light
      light = new THREE.HemisphereLight(0xffbf67, 0x15c6ff);
      scene.add(light);

      //WebGL Renderer
      renderer = new THREE.WebGLRenderer({antialias: true});
      renderer.setSize(w, h);

      $('.webgl').append(renderer.domElement);

      data = generateHeight( worldWidth, worldDepth );
      camera.position.y = data[ worldHalfWidth + worldHalfDepth * worldWidth ] * 10 + 500;

      var geometry = new THREE.PlaneBufferGeometry( 1500, 1500, worldWidth - 1, worldDepth - 1 );
      geometry.rotateX( - Math.PI / 2 );

      var vertices = geometry.attributes.position.array;
      for ( var i = 0, j = 0, l = vertices.length; i < l; i ++, j += 3 ) {
        vertices[ j + 1 ] = data[ i ] * 10;
      }
      texture = new THREE.CanvasTexture( generateTexture( data, worldWidth, worldDepth ) );
      texture.wrapS = THREE.ClampToEdgeWrapping;
      texture.wrapT = THREE.ClampToEdgeWrapping;

      mesh = new THREE.Mesh( geometry, new THREE.MeshBasicMaterial( { map: texture } ) );
      mesh.position.set( 8, -300, 0 );
      scene.add( mesh );

      var posX = camera.position.x - 100;
      var posY = camera.position.y + 200;
      var posZ = camera.position.z + 800;

      //Box button
      var btngeom = new THREE.BoxGeometry( 30, 30, 3 );
      var btmmat = new THREE.MeshBasicMaterial( {color: 0xff0000,} );
      cube1 = new THREE.Mesh( btngeom, btmmat );
      cube1.position.set( 0, 500, -80 );
      scene.add( cube1 );

          container1 = document.createElement( 'div' );
          document.body.appendChild( container1 );
          var info = document.createElement( 'div' );
          info.style.position = 'absolute';
          info.style.bottom = '10px';
          info.style.width = 'auto';
          info.style.left = '55%';
          info.style.textAlign = 'center';
          info.innerHTML = '<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#ClickContent1">Next</button>';
          container1.appendChild( info );
          container1.addEventListener("click", onClick1);

          container2 = document.createElement( 'div' );
          document.body.appendChild( container2 );
          var info = document.createElement( 'div' );
          info.style.position = 'absolute';
          info.style.bottom = '10px';
          info.style.left = '45%';
          info.style.width = 'auto';
          info.style.textAlign = 'center';
          info.innerHTML = '<button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#ClickContent2">Prev</button>';
          container2.appendChild( info );
          container2.addEventListener("click", onClick2);

      var domEvents   = new THREEx.DomEvents(camera, renderer.domElement);
      domEvents.addEventListener(cube1, 'click', function(event){

      }, false);

      domEvents.addEventListener(cube1, 'mouseover', function(event){
          cube1.material.color.setHex('0x' + 'ffff00');
      }, false);
      domEvents.addEventListener(cube1, 'mouseout', function(event){
          cube1.material.color.setHex('0x' + 'ff0000');
      }, false);


      // define the callback
      function onClick1(event){

        var from = {
          x: camera.position.x,
          y: camera.position.y,
          z: camera.position.z
        };

        var to = {
            x: posX,
            y: posY,
            z: posZ
        };
        var tween = new TWEEN.Tween(from)
            .to(to, 600)
            .easing(TWEEN.Easing.Linear.None)
            .onUpdate(function () {
            camera.position.set(this.x, this.y, this.z);
            camera.lookAt(new THREE.Vector3(0, 0, 0));
        })
            .onComplete(function () {
            camera.lookAt(new THREE.Vector3(0, 0, 0));

        event.stopPropagation();

        })
        .start();

      }

      // add an event listener for this callback
      domEvents.addEventListener(cube1, 'click', onClick1, false)

      //camera.position.set(0, 1000, -1500);

      var posX2 = camera.position.x + 800;
      var posY2 = camera.position.y + 100;
      var posZ2 = camera.position.z + 1000;

      //Box button
      var btngeom = new THREE.BoxGeometry( 30, 30, 3 );
      var btmmat = new THREE.MeshBasicMaterial( {color: 0xff0000,} );
      cube2 = new THREE.Mesh( btngeom, btmmat );
      cube2.position.set( 200, 500, 20 );
      cube2.rotateY(90);
      scene.add( cube2 );


      var domEvents   = new THREEx.DomEvents(camera, renderer.domElement);
      domEvents.addEventListener(cube2, 'click', function(event){
          //console.log('you clicked on the cube2')
      }, false);

      domEvents.addEventListener(cube2, 'mouseover', function(event){
          cube2.material.color.setHex('0x' + 'ffff00');
      }, false);
      domEvents.addEventListener(cube2, 'mouseout', function(event){
          cube2.material.color.setHex('0x' + 'ff0000');
      }, false);

      // define the callback
      function onClick2(event){
      //console.log('you clicked on the cube2')
        var from = {
          x: camera.position.x,
          y: camera.position.y,
          z: camera.position.z
        };

        var to = {
            x: posX2,
            y: posY2,
            z: posZ2
        };
        var tween = new TWEEN.Tween(from)
            .to(to, 600)
            .easing(TWEEN.Easing.Linear.None)
            .onUpdate(function () {
            camera.position.set(this.x, this.y, this.z);
            camera.lookAt(new THREE.Vector3(0, 0, 0));
        })
            .onComplete(function () {
            camera.lookAt(new THREE.Vector3(0, 0, 0));
        })
        .start();
        }

      // add an event listener for this callback
      domEvents.addEventListener(cube2, 'click', onClick2, false)

  }/*init*/


  function generateHeight( width, height ) {

    var size = width * height, data = new Uint8Array( size ),
    perlin = new ImprovedNoise(), quality = 1, z = 2 * 100;

    for ( var j = 0; j < 4; j ++ ) {

      for ( var i = 0; i < size; i ++ ) {

        var x = i % width, y = ~~ ( i / width );
        data[ i ] += Math.abs( perlin.noise( x / quality, y / quality, z ) * quality * 1.75 );
      }

      quality *= 5;
    }

    return data;

  }

  function generateTexture( data, width, height ) {

    var canvas, canvasScaled, context, image, imageData,
    level, diff, vector3, sun, shade;

    vector3 = new THREE.Vector3( 0, 0, 0 );

    sun = new THREE.Vector3( 1, 1, 1 );
    sun.normalize();

    canvas = document.createElement( 'canvas' );
    canvas.width = width;
    canvas.height = height;

    context = canvas.getContext( '2d' );
    context.fillStyle = '#000';
    context.fillRect( 0, 0, width, height );

    image = context.getImageData( 0, 0, canvas.width, canvas.height );
    imageData = image.data;

    for ( var i = 0, j = 0, l = imageData.length; i < l; i += 4, j ++ ) {

      vector3.x = data[ j - 2 ] - data[ j + 2 ];
      vector3.y = 2;
      vector3.z = data[ j - width * 2 ] - data[ j + width * 2 ];
      vector3.normalize();

      shade = vector3.dot( sun );

      imageData[ i ] = ( 96 + shade * 128 ) * ( 0.5 + data[ j ] * 0.007 );
      imageData[ i + 1 ] = ( 32 + shade * 96 ) * ( 0.5 + data[ j ] * 0.007 );
      imageData[ i + 2 ] = ( shade * 96 ) * ( 0.5 + data[ j ] * 0.007 );
    }

    context.putImageData( image, 0, 0 );

    // Scaled 4x

    canvasScaled = document.createElement( 'canvas' );
    canvasScaled.width = width * 4;
    canvasScaled.height = height * 4;

    context = canvasScaled.getContext( '2d' );
    context.scale( 4, 4 );
    context.drawImage( canvas, 0, 0 );

    image = context.getImageData( 0, 0, canvasScaled.width, canvasScaled.height );
    imageData = image.data;

    for ( var i = 0, l = imageData.length; i < l; i += 4 ) {

      var v = ~~ ( Math.random() * 5 );

      imageData[ i ] += v;
      imageData[ i + 1 ] += v;
      imageData[ i + 2 ] += v;

    }

    context.putImageData( image, 0, 0 );

    return canvasScaled;

  }

  function animate() {
      TWEEN.update();
      requestAnimationFrame(animate);
      renderer.render(scene, camera);
      controls.update();
  }

</script>



</body>
</html>